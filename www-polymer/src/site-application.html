<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/iron-selector/iron-selector.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../bower_components/paper-spinner/paper-spinner-lite.html">
<link rel="import" href="../bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../bower_components/paper-scroll-header-panel/paper-scroll-header-panel.html">

<!-- custom elements -->
<link rel="import" href="my-icons.html">
<link rel="import" href="site-carousel.html">
<link rel="import" href="styles/normalize.html">
<link rel="import" href="styles/shared-styles.html">

<!-- behaviors -->
<link rel="import" href="behaviors/preload-image-behavior.html">

<!-- scripts -->
<script src="js/TweenMax.min.js"></script>
<script src="js/ScrollToPlugin.min.js"></script>
<script src="js/swiper.min.js"></script>

<dom-module id="site-application">
  <template>
    <style include="normalize shared-styles">

      :host {
/*        --app-primary-color: #4285f4;
        --app-secondary-color: black;*/
        
        --primary: #CF6059;
        --offWhite: #ebe0dd;
        --offPink: #D9B5B6;
        --box-shadow-slight: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
        --box-shadow-light: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
        --box-shadow-high: 0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23);

        display: block;
      }

      /* typography */
      h1, h2, h3, h4, h5, h6, p, span, li {
        color: #000;
      }
  
      h1 {
        font: 32px/32px 'Nixie One', cursive;
      }
        
        /*@media $tablet
          font 24px/32px 'Nixie One', cursive*/
        
      h2, 
      h3 {
        font: 28px/28px 'Nixie One', cursive;
      }
        

      h4, 
      h5, 
      h6 {
        font: 28px/32px 'Nixie One', cursive;
      }
        
       /* @media $tablet
          font 22px/32px 'Nixie One', cursive*/
        
      p,
      span,
      li {
        font: 400 14px/24px 'Lato', sans-serif;
      }

      a {
        color: #fff;
        font: 700 16px/24px 'Lato', sans-serif;
      }

      /*
      * paper-drawer-panel selector
      * site shell
      */
      .site {

      }

      /*
      * Off Canvas Nav
      */
      .offcanvas--links a {
        display: block;
        padding: 0 16px;
        text-decoration: none;
        color: var(--primary);
        line-height: 40px;
      }

      .offcanvas--links a.iron-selected {
        color: black;
        font-weight: bold;
      }

      .offcanvas--links paper-icon-button {
        color: black;
        --paper-icon-button-ink-color: var(--primary);
      }

      /*
      * Header
      */
      .site--content-header {
        background: #FFF;
        -webkit-box-shadow: var(--box-shadow-slight);
                box-shadow: var(--box-shadow-slight);
      }

      .content--header-nav {
        display: -webkit-flex;
        display: -moz-flex;
        display: -ms-flex;
        display: -o-flex;
        display: flex;
        -webkit-flex: 1px;
        -ms-flex: 1px;
        flex: 1px;
        -webkit-flex-direction: row;
            -ms-flex-direction: row;
                flex-direction: row;
        -webkit-align-items: center;
                align-items: center;
        justify-content: space-between;
      }

      .content--header-nav a {
        color: var(--primary);
      }

      .content--header-title {
        -webkit-flex: 1px;
        -ms-flex: 1px;
        flex: 1px;
      }

      /* hamburger btn */
      .content--menu-btn {
        color: #fff;
        --paper-icon-button-ink-color: #fff;
      }

      /* ===============================================
      *  Main Content Styles ===========================
         ===============================================
      */
      .site--content-main {
        opacity: 0;
      }

      ./*site--content-main section {
        padding: 0 25px;
        -webkit-box-sizing: border-box;
           -moz-box-sizing: border-box;
                box-sizing: border-box;
      }*/
      /* test styles - delete */
      .__test-section {
        height: 2000px;
        width: 100%;
      }

      .content--gallery site-carousel {
        margin: 50px auto;
      }

      #spinner {
        position: absolute;
        left: 50%;
        top: 50%;
        width: 100%;
        height: 100%;
        margin: 0 auto;
      }

      /* hero styls
         TODO: move to shared-styles
      */
      .content--hero {
        background: url('../images/bg-hero.jpg');
        background-repeat: no-repeat;
        -webkit-background-size: cover;
             -o-background-size: cover;
                background-size: cover;
        background-position: center center;
        -webkit-box-sizing: border-box;
           -moz-box-sizing: border-box;
                box-sizing: border-box;
      }
      
      .hero--copy {
        display: -webkit-flex;
        display: -moz-flex;
        display: -ms-flex;
        display: -o-flex;
        display: flex;
        width: 100%;
        max-width: 1140px;
        margin: 0 auto;
        padding: 100px 25px;
        
      }

      .hero--card h1 {
        margin: 0;
      }

      .hero--card,
      .hero--logo {
        -webkit-flex: 1;
            -ms-flex: 1;
                flex: 1;
        padding: 25px;
        -webkit-box-sizing: border-box;
           -moz-box-sizing: border-box;
                box-sizing: border-box;
      }

      .hero--card {
        background: #FFF;
        padding: 50px;
        -webkit-border-radius: 4px;
                border-radius: 4px;
        -webkit-box-shadow: var(--box-shadow-high);
                box-shadow: var(--box-shadow-high);
      }

    </style>

    <!-- site shell -->
    <paper-drawer-panel force-narrow disable-swipe class="site">

      <!-- off canvas menu -->
      <paper-header-panel drawer class="site--offcanvas-nav" id="paperDrawer">
        <!-- off canvas header -->
        <paper-toolbar class="offcanvas--header">
          <h3 class="offcanvas--header-title">Mobile</h3>
        </paper-toolbar>

        <!-- off canvas nav -->
        <iron-selector class="offcanvas--links" selected="[[page]]" attr-for-selected="name" role="navigation">
           <a paper-drawer-toggle on-tap="_scrollToPricing">PRICING</a>
           <a paper-drawer-toggle on-tap="_scrollToGallery">GALLERY</a>
           <a paper-drawer-toggle on-tap="_scrollToServices">SERVICES</a>
           <a paper-drawer-toggle on-tap="_scrollToContent">CONTENT</a>
           <paper-icon-button icon="social:facebook-alt" class="content--menu-btn" paper-drawer-toggle></paper-icon-button>
           <paper-icon-button icon="social:twitter-alt" class="content--menu-btn" paper-drawer-toggle></paper-icon-button>
           <paper-icon-button icon="social:instagram" class="content--menu-btn" paper-drawer-toggle></paper-icon-button>
        </iron-selector>
      </paper-header-panel>

      <!-- site main/body content section -->
      <paper-scroll-header-panel main class="site--content" id="siteContent">

        <!-- main content header -->
        <paper-toolbar class="site--content-header">

          <!-- header nav left -->
          <div class="content--header-title">Title</div>

          <!-- header nav right/links -->
          <iron-selector selected="[[page]]" attr-for-selected="name" class="content--header-nav" role="navigation">

            <a on-tap="_scrollToPricing">PRICING</a>
            <a on-tap="_scrollToGallery">GALLERY</a>
            <a on-tap="_scrollToServices">SERVICES</a>
            <a on-tap="_scrollToContent">CONTENT</a>
            <!-- menu btn -->
            <paper-icon-button icon="iconz:menu" class="content--menu-btn" paper-drawer-toggle></paper-icon-button>

          </iron-selector>

        </paper-toolbar>

        <!-- loading spinner -->
        <div id="spinner">
          <paper-spinner-lite active></paper-spinner-lite>
        </div>

        <!-- main content container -->
        <div class="site--content-main" id="siteMain">

          <!-- hero -->
          <section class="content--hero" id="hero">

            <div class="hero--copy">
              <div class="hero--card">
                <h1>Hand Made.</h1>
                <br>
                <h1>Just for you.</h1>
                <p>Everything is better with A Touch of Sweetness!  Life is full of special occasions.  From newborn babies, graduations, weddings or birthdays, there's always something to celebrate!  Let us add to the celebration by creating something special and unique to the event.  Wether it's cupcakes, fruit and dessert trays, or a custom designed cake, things are always better with A Touch of Sweetness!</p>
              </div>

              <div class="hero--logo"></div>
 
            </div>

            <content select="[hero-title]"></content>
            <content select="[hero-copy]"></content>

          </section>

          <!-- pricing -->
          <section class="content--pricing" id="pricing">

          </section>

          <iron-ajax
              auto
              url="../data.json"
              handle-as="json"
              last-response="{{response}}"
              on-response="_onResponse"
              debounce-duration="300">
          </iron-ajax>

          <!-- gallery -->
          <section class="content--gallery" id="gallery">
            
            <div class="gallery-guts" id="guts">
              <h1>Cakes</h1>
              <site-carousel images="{{imagesCakes}}"></site-carousel>

              <h1>Cupcakes</h1>
              <site-carousel images="{{imagesCupCakes}}"></site-carousel>

              <h1>Desserts</h1>
              <site-carousel images="{{imagesDesserts}}"></site-carousel>
            </div>
            
          </section>

          <!-- services -->
          <section class="content--services" id="services">

          </section>

          <!-- contact -->
          <section class="content--contact">

          </section>

        </div>

      </paper-scroll-header-panel>

    </paper-drawer-panel>

  </template>

  <script>

    Polymer({
      is: 'site-application',

      properties: {
        response: {
          type: Array,
          notify: true
        },

        imagesCakes: {
          type: Array,
          notify: true
        },

        imagesCakes: {
          type: Array,
          notify: true
        },

        imagesDesserts: {
          type: Array,
          notify: true
        },

        preloadManifest: {
          type: Array,
          value: function() {
            return [
              '../images/bg-hero-mobile.jpg', 
              '../images/bg-hero.jpg'
            ]
          }
        }

      },

      behaviors: [
        Polymer.PreloadImagesBehavior
      ],

      ready: function() {
        this.async(function() {
          this.preloadImages(this.preloadManifest, this._imagesAreLoaded());
        }, 1250);
      },

      _imagesAreLoaded: function() {
        console.log('images are loaded');
        TweenMax.to(this.$.spinner, 0.5, { opacity: 0});
        TweenMax.to(this.$.siteMain, 1, { opacity: 1});
      },

      _onResponse: function() {
        // console.log(this.response.images[0].imagesCakes.length, this.response.images[0].imagesCakes.length - 1);
        this.imagesCakes = this.response.images.imagesCakes;
        this.imagesCupCakes = this.response.images.imagesCupCakes;
        this.imagesDesserts = this.response.images.imagesDesserts;
      },

      /*
      * scroll to section animation
      * @param (element): the element/section to animate to
      */
      navItemClicked: function(element) {

        TweenMax.to(this.$.siteContent.scroller, 1, {
            scrollTo: {
                y: element.offsetTop,
                autoKill: true
            },
            ease:Power2.easeOut
        });

      },

      _scrollToPricing: function() {
        this.navItemClicked(this.$.pricing);
      },

      _scrollToGallery: function() {
        this.navItemClicked(this.$.gallery);
      },

      _scrollToServices: function() {
        this.navItemClicked(this.$.services);
      },

      _scrollToContact: function() {
        this.navItemClicked(this.$.contact);
      },

    });
  </script>
</dom-module>
